# Xerces-C 2.7.0 library compiled on CheriBSD-Morello

## 1. Download Xerces-C 2.7
```bash
git clone https://github.com/apache/xerces-c.git
cd xerces-c && git checkout -b v2.7.0 v2.7.0

export XERCESCROOT=/home/iiswc/xerces-c

cd src/xercesc

./runConfigure -p freebsd -c /usr/local64/bin/clang-morello -x /usr/local64/bin/clang++-morello  -r none -m inmem -P /home/iiswc/xerces-c/libs/xerces-c-2.7 -b 64 -n fileonly -z "-Wno-c++11-narrowing"
gmake

# copy *.so files in `../../lib/` to host machine for cross-compilation
```


## 2. Cross-compile 523.xalancbmk_r
### 2.1 Comment the following lines in `~/cheri/cheribsd/tools/build/cross-build/include/linux/limits.h`
```c++
/*
#if __has_include(<linux/limits.h>)
#include <linux/limits.h>
#endif
 */
```

### 2.2 Change the following codes in the files
`~/workspace/SPEC/cpu2017-1.1.0/benchspec/CPU/523.xalancbmk_r/src`
+ ./AIXPlatformUtils.cpp
+ ./HPPlatformUtils.cpp
+ ./IRIXPlatformUtils.cpp
+ ./LinuxPlatformUtils.cpp

```c++
#include <sys/timeb.h>

timeb aTime;
ftime(&aTime);            
return (unsigned long)(aTime.time*1000 + aTime.millitm);
```

to

```c++
#include <sys/time.h>

struct timeval aTime;
gettimeofday(&aTime, NULL);
return (unsigned long)(aTime.tv_sec * 1000) + (aTime.tv_usec / 1000);
```