# QuickJS

## Step 1: Download from github
> running on development manchine
```bash
cd ~/workspace
git clone https://github.com/bellard/quickjs.git
cd quickjs

git clone https://github.com/tc39/test262.git test262
cd test262
patch -p1 < ../tests/test262.patch
```
>commit: 4d9a27c578d20fc22f0f1a51ff3bfaf47798f30e

## Step 2: Cross-compile
> running on development manchine

#### Step 2.1: generate binaries
```bash
./quickjs/cross-compile/compile
```

It it a correct process when the compilation error occurs at the first stage.
The compilation error is caused by the missing of the `reply.c` file that is generated by the `qjsc` command on remote device.
The script will automatically generate the `reply.c` file from the remote and copy it to the local machine.
Then, the second-stage compilation will be successful.

Check the compilated binaries in the `build-cheribsd-morello-*` folders.

#### Step 2.2: setup and generate launch script(s)
```bash
./quickjs/run/setup
```

#### Step 2.3: distribute binaries
```bash
./quickjs/run/distribute <destination-ip: 192.168.1.101>
```

## Step 3: Run 
> running on CheriBSD-Morello

#### Step 3.1: validate binary ABIs
```bash
./quickjs/run/check-abi <destination-ip: 192.168.1.101>
```

#### Step 3.2: launch
```bash
./quickjs/run/launch <destination-ip: 192.168.1.101> <result-folder: ./results/quickjs>
```

## Step 4: Output results
```bash
# Modify this file as needed
./quickjs/run/verbose
# or
./quickjs/run/verbose-list
```
